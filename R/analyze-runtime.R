#' @title Function \code{runtime}
#' @description Runtimes in computation study
#' @export
#' @return runtime table
#' @param from directory with simulation lists
#' @param to output directory
#' @param analysis to get runtimes of
runtime = function(from, to, analysis = "fullybayes+normal"){
  from = newdir(from)
  to = newdir(to)
  long = NULL
  for(f in list.files(from)){
    print(f)
    l = readRDS(paste0(from, f))
    a = l$analyses[[analysis]]
    runtime = a$runtime["elapsed"]/3600
    names(runtime) = NULL
    min_ess = min(a$ess[c("nu", "tau", paste0("theta_", 1:5), paste0("sigmaSquared_", 1:5))])
    median_ess = median(a$ess[c("nu", "tau", paste0("theta_", 1:5), paste0("sigmaSquared_", 1:5))])
    runtime_per_min_ess_100 = 100* runtime/min_ess
    runtime_per_median_ess_100 = 100* runtime/median_ess
    names(runtime_per_min_ess_100) = NULL
    names(runtime_per_median_ess_100) = NULL
    long = rbind(long, c(G = a$chains[[1]]@G, N = a$chains[[1]]@N,
      runtime = runtime, min_ess = min_ess, median_ess = median_ess,
      runtime_per_min_ess_100 =  runtime_per_min_ess_100,
      runtime_per_median_ess_100 = runtime_per_median_ess_100))
  }
  long = as.data.frame(long)
  out = list(long = long)
  for(n in colnames(long)[3:7]){
    out[[n]] = t(matrix(long[,n], nrow = length(unique(long$G)), ncol = length(unique(long$N))))
    rownames(out[[n]]) = unique(long$G)
    colnames(out[[n]]) = unique(long$N)
  }
  saveRDS(out, paste0(to, "runtime_", analysis, ".rds"))
}

